<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fun with Grid Cells</title>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="../bhtms-grid-cells-0.2.2.js"></script>
    <script src="../bhtms-how-do-grid-cells-work-0.2.2.js"></script>

    <style>
        body {
            font-family: Helvetica;
            width: 450px;
        }
        a {
            text-decoration: underline;
        }
    </style>
</head>

<body>

<h1>Fun with Grid Cells</h1>

<p>
    We have learned a lot about the brain over the past few decades. One of the most exciting discoveries of modern neuroscience is how certain cells in the brain respond to and represent location in space. In 2014, the Nobel Prize for Physiology or Medicine was awarded to Drs May-Britt Moser, Edvard Moser, and and John O'Keefe for their work discovering cells that deal with location in the brain. This included cells called "grid cells", which are pyramidal neurons that seem to create cognitive maps of space.
</p>

<h2>The Discovery of Grid Cells</h2>

<p>
    In this experiment, a mouse has an apparatus that is monitoring one particular neuron in its entorhinal cortex suspected to be involved with location. Every time the neuron fires an action potential, a dot is rendered to the screen in this video.
</p>

<p>
    At first, it looks like the neuron is just firing randomly, but as the mouse explores the room completely, you can clearly see a grid-like firing field appear across the 2d space. This shows that this one neuron, called a "grid cell", responds when the mouse is in particular places in the room, and those places are spaced out in a hexagonal lattice.
</p>

<h2>A simulation of Grid Cells in Action</h2>

<p>
    In the interactive visualization below, you can see an object moving through a 2-dimensional space, where the space wraps at the edges. This 2D space is being mapped by 3 grid cells, each one being represented with a different color. The color splotches are each grid cell's firing fields, or the locations in the space where the cell has fired in response to the object's location.
</p>

<p>
    As the grid cells' firing fields fill in, notice that each one is a hexagonal lattice, and that they project slightly differently across the space.
</p>

<div id="gridCellFiringFields" class="widget"></div>

<p>
    If you're a fast reader, the firing fields may not have filled in much yet. If you are at a desktop computer, hover your mouse over the 2D space to control the location of the object and watch as each grid cell fires in response to your movement. See if you can find the firing fields yourself as you move the cursor across the space.
</p>

<p>
    Use the checkboxes above to show only <a onclick="showOnly('red')">red</a> cell's firing fields, then compare it to the <a onclick="showOnly('blue')">blue</a> and <a onclick="showOnly('green')">green</a> cells. You can turn them back on by toggling the checkboxes above.
</p>

<h2>One Grid Cell / One Dimension</h2>

<div id="oneDimensionalMapping"></div>

<p>
    I don't know what to say about this yet but try <a onclick="doit()">clicking here</a> to reset the sliders.
</p>

<h2>The Grid Cell Module</h2>
<blockquote>
    How Many Grid Cells Work together to tile a space.
</blockquote>

<h2>Grid Cell Modules Working Together</h2>
<blockquote>
    How Many GCMs work together to create a unique representation of any space.
</blockquote>

<script type="text/javascript">
    $(function() {
        BHTMS.gridCellFiringFields("gridCellFiringFields")
        window.showOnly = (color) => {
            BHTMS.gridCellFiringFields.selectCellByColor(color)
        }


        BHTMS.oneDimensionalMapping('oneDimensionalMapping')
        var jsds = BHTMS.JSDS.get('1-d-mapping');

        window.doit = () => {
            let cuts = 20,
                speed = 50
                current = 0,
                targetParams = {
                    anchor: 0,
                    range: 0.75,
                    scale: 0.1,
                    independentVars: 6,
                }


            function againForTheFirstTime(targetParams) {
                let params = jsds.get('params')
                let anchorScale = d3.scaleLinear()
                    .domain([0, cuts])
                    .range([params.anchor, targetParams.anchor])
                let rangeScale = d3.scaleLinear()
                    .domain([0, cuts])
                    .range([params.range, targetParams.range])
                let scaleScale = d3.scaleLinear()
                    .domain([0, cuts])
                    .range([params.scale, targetParams.scale])
                let independentVarsScale = d3.scaleLinear()
                    .domain([0, cuts])
                    .range([params.independentVars, targetParams.independentVars])
                setTimeout(function() {
                    jsds.set('params', {
                        anchor: anchorScale(current),
                        range: rangeScale(current),
                        scale: scaleScale(current),
                        independentVars: independentVarsScale(current),
                    })
                    current++;
                    if (current < cuts) {
                        againForTheFirstTime(targetParams);
                    }
                }, speed);
            }

            againForTheFirstTime(targetParams)
        }
    });
</script>


</body>

</html>
